\documentclass[polish,envcountsect,10pt]{beamer}
\usetheme{metropolis}
\usepackage[T1]{fontenc}
\usepackage{polski}
\usepackage{babel}
\usepackage{tikz}
\usepackage{graphicx}
\usepackage{xcolor}
\usepackage{algorithm}
\usepackage{algpseudocode}
\graphicspath{ {./img/} }

\title{Triangulacja i diagramy Voronoi}
\author{Krzysztof Nasuta}
\date{Gdańsk, 2025}
\setbeamertemplate{footline}[frame number]

\begin{document}

\frame{\titlepage}

\begin{frame}
  \frametitle{Triangulacja w geometrii}
  \begin{definition}
    Sympleks to uogólnienie trójkąta i czworościanu na dowolne wymiary. Są to najprostsze możliwe obiekty geometryczne w danym wymiarze.
  \end{definition}

  \pause
  Dla przykładu:
  \begin{itemize}
    \item 0-wymiarowy sympleks to punkt,
    \item 1-wymiarowy sympleks to odcinek,
    \item 2-wymiarowy sympleks to trójkąt,
    \item 3-wymiarowy sympleks to czworościan,
  \end{itemize}
\end{frame}

\begin{frame}
  \frametitle{Triangulacja w geometrii}
  \begin{definition}
    Triangulacja to podział płaszczyzny euklidesowej na trójkąty. W ogólności mówi się o podziale przestrzeni euklidesowej na sympleksy odpowiedniego wymiaru.

    \pause
    Zazwyczaj wymagane jest, aby krawędzie i wierzchołki sympleksów pokrywały się w całości z krawędziami i wierzchołkami innych sympleksów.
  \end{definition}
\end{frame}

\begin{frame}
  \frametitle{Triangulacja w geometrii - przykład dwuwymiarowy}
  \begin{center}
    \begin{figure}
      \begin{tikzpicture}
        \draw (1.3, 1.5) -- (1.6, 2.6) -- (3.0, 2.9) -- (4.1, 1.5) -- (5.1, 1.5) -- (3.5, 3.7) -- (1.2, 3.4) -- (0.4, 1.5) -- (1.5, 0.2) -- (2.9, 0.4) -- (3.2, 1.5) -- (2.3, 1.5) -- (2.4, 1.3) -- (1.9, 1.0) -- cycle;

        \pause
        \draw (7.8, 1.3) -- (7.4, 1.0) -- (8.3, 0.4) -- cycle;
        \draw (7.8, 1.3) -- (8.3, 0.4) -- (8.6, 1.5) -- cycle;
        \draw (7.8, 1.3) -- (8.6, 1.5) -- (7.7, 1.5) -- cycle;
        \draw (6.9, 0.2) -- (8.3, 0.4) -- (7.4, 1.0) -- cycle;
        \draw (6.9, 0.2) -- (7.4, 1.0) -- (5.8, 1.5) -- cycle;
        \draw (5.8, 1.5) -- (7.4, 1.0) -- (6.7, 1.5) -- cycle;
        \draw (5.8, 1.5) -- (6.7, 1.5) -- (7.0, 2.6) -- cycle;
        \draw (5.8, 1.5) -- (7.0, 2.6) -- (6.6, 3.4) -- cycle;
        \draw (7.0, 2.6) -- (8.5, 2.9) -- (6.6, 3.4) -- cycle;
        \draw (9.6, 1.5) -- (10.5, 1.5) -- (8.5, 2.9) -- cycle;
        \draw (8.9, 3.7) -- (6.6, 3.4) -- (8.5, 2.9) -- cycle;
        \draw (8.9, 3.7) -- (8.5, 2.9) -- (10.5, 1.5) -- cycle;
      \end{tikzpicture}
      \caption{Podział płaszczyzny na trójkąty}
    \end{figure}
  \end{center}
\end{frame}

\begin{frame}
  \frametitle{Triangulacja w geometrii - przykład trójwymiarowy}
  \begin{center}
    \begin{figure}
      \includegraphics[scale=0.5]{3d-triangulation}
      \caption{Podział bryły na czworościany}
    \end{figure}
  \end{center}
\end{frame}

\begin{frame}
  \frametitle{Triangulacja w teorii grafów}
  \begin{definition}
    Graf planarny to graf, który można narysować na płaszczyźnie w taki sposób, że jego krawędzie nie przecinają się ze sobą.
  \end{definition}

  \begin{example}
    \begin{center}
      \begin{figure}
        \begin{tikzpicture}[scale=0.7]
          \node[circle, draw, fill=blue!20, label=left:{$v_1$}] (v1) at (2,3) {};
          \node[circle, draw, fill=blue!20, label=below:{$v_2$}] (v2) at (2,0) {};
          \node[circle, draw, fill=blue!20, label=below:{$v_3$}] (v3) at (0,-2) {};
          \node[circle, draw, fill=blue!20, label=left:{$v_4$}] (v4) at (-2,-1) {};
          \node[circle, draw, fill=blue!20, label=below:{$v_5$}] (v5) at (5,0) {};
          \node[circle, draw, fill=blue!20, label=left:{$v_6$}] (v6) at (-2,2) {};

          \coordinate (ctrl-5-6) at (2,4);

          \draw (v1) -- (v2);
          \draw (v1) -- (v5);
          \draw (v2) -- (v3);
          \draw (v2) -- (v4);
          \draw (v2) -- (v5);
          \draw (v3) -- (v4);
          \draw (v4) -- (v1);
          \draw (v4) -- (v6);
          \draw (v5) to[out=90, in=0] (ctrl-5-6) to[out=180, in=90] (v6);
        \end{tikzpicture}
        \caption{Przykład grafu planarnego}
      \end{figure}
    \end{center}
  \end{example}
\end{frame}

\begin{frame}
  \frametitle{Triangulacja w teorii grafów}
  \begin{definition}
    Maksymalny graf planarny to \textbf{graf planarny, do którego nie można dodać żadnej krawędzi bez utraty własności planarnych}. W maksymalnym grafie planarnym każda ściana jest trójkątem (wliczając ścianę zewnętrzną).
  \end{definition}

  \pause
  \begin{definition}
    Triangulacja to \textbf{proces tworzenia grafu maksymalnie planarnego ze zbioru punktów}.
  \end{definition}

  \pause
  \begin{theorem}
    Jeśli maksymalny graf planarny ma $n$ wierzchołków, gdzie $n \geq 3$, to ma dokładnie $3n - 6$ krawędzi i $2n - 4$ ścian. \qed
  \end{theorem}
\end{frame}

\begin{frame}
  \frametitle{Triangulacja w teorii grafów - przykład}
  \begin{center}
    \begin{figure}
      \begin{tikzpicture}[scale=0.5]
        \node[circle, draw, fill=blue!20, label=left:{$v_1$}] (v1) at (0,5) {};
        \node[circle, draw, fill=blue!20, label=right:{$v_2$}] (v2) at (0,0) {};
        \node[circle, draw, fill=blue!20, label=left:{$v_3$}] (v3) at (0,-5) {};
        \node[circle, draw, fill=blue!20, label=above:{$v_4$}] (v4) at (2,2) {};
        \node[circle, draw, fill=blue!20, label=below:{$v_5$}] (v5) at (2,-2) {};
        \node[circle, draw, fill=blue!20, label=right:{$v_6$}] (v6) at (-2,2) {};
        \node[circle, draw, fill=blue!20, label=left:{$v_7$}] (v7) at (-2,-2) {};
        \node[circle, draw, fill=blue!20, label=below:{$v_8$}] (v8) at (-6,0) {};
        \node[circle, draw, fill=blue!20, label=below:{$v_9$}] (v9) at (6,0) {};
        \node[circle, draw, fill=blue!20, label=below:{$v_{10}$}] (v10) at (-9,0) {};
        \node[circle, draw, fill=blue!20, label=below:{$v_{11}$}] (v11) at (9,0) {};

        \coordinate (ctrl-1-3) at (11, 0);

        \pause
        \draw (v1) -- (v6);
        \pause
        \draw (v1) -- (v2);
        \draw (v2) -- (v6);
        \pause
        \draw (v1) to[out=0, in=90] (ctrl-1-3) to[out=-90, in=0] (v3);
        \draw (v1) -- (v4);
        \draw (v1) -- (v8);
        \draw (v1) -- (v9);
        \draw (v1) -- (v10);
        \draw (v1) -- (v11);
        \draw (v2) -- (v3);
        \draw (v2) -- (v4);
        \draw (v2) -- (v5);
        \draw (v2) -- (v7);
        \draw (v2) -- (v8);
        \draw (v2) -- (v9);
        \draw (v3) -- (v5);
        \draw (v3) -- (v7);
        \draw (v3) -- (v8);
        \draw (v3) -- (v9);
        \draw (v3) -- (v10);
        \draw (v3) -- (v11);
        \draw (v4) -- (v9);
        \draw (v5) -- (v9);
        \draw (v6) -- (v8);
        \draw (v7) -- (v8);
        \draw (v8) -- (v10);
        \draw (v9) -- (v11);

        \pause
        \draw[fill=blue!30, draw=black] (0,5) -- (0,0) -- (-2,2) -- cycle;
        \node[fill=white] at (0,-2) {Wszystkie ściany są trójkątami (także zewnętrzna)};
      \end{tikzpicture}
      \caption{Graf Goldnera-Harary'ego - przykład grafu maksymalnie planarnego o 11 wierzchołkach i 27 krawędziach}
    \end{figure}
  \end{center}
\end{frame}

\begin{frame}
  \frametitle{Triangulacja w teorii grafów}
  \begin{definition}
    Cykl indukowany to taki cykl w grafie, że żadne dwa jego wierzchołki nie są połączone krawędzią, która nie należy do cyklu.
  \end{definition}

  \begin{definition}
    Graf cięciwowy to graf, w którym każdy \textbf{cykl o długości czterech lub większej ma przekątną}, czyli krawędź łączącą dwa niekolejne wierzchołki cyklu.

    W grafie takim cykle indukowane mają zawsze długość 3.
  \end{definition}
  \pause
  \begin{definition}
    Triangulacja to proces dodawania krawędzi do grafu w celu \textbf{otrzymania grafu cięciwowego}.
  \end{definition}
\end{frame}

\begin{frame}
  \frametitle{Triangulacja w teorii grafów - przykład}
  \begin{center}
    \begin{figure}
      \begin{tikzpicture}[scale=1.0]
        \node[circle, draw, fill=blue!20, label=left:{$v_1$}] (v1) at (0,1) {};
        \node[circle, draw, fill=blue!20, label=above:{$v_2$}] (v2) at (-2,0) {};
        \node[circle, draw, fill=blue!20, label=above:{$v_3$}] (v3) at (-1,-2) {};
        \node[circle, draw, fill=blue!20, label=below:{$v_4$}] (v4) at (1.5,-2) {};
        \node[circle, draw, fill=blue!20, label=below:{$v_5$}] (v5) at (3,0) {};

        \draw (v1) -- (-0.5, 2);
        \draw (v1) -- (v2);
        \draw (v2) -- (-3, 0.25);
        \draw (v2) -- (v3);
        \draw (v3) -- (-2, -2.25);
        \draw (v3) -- (-1.75, -2.75);
        \draw (v3)-- (-0.5, -2.75);
        \draw (v3) -- (v4);
        \draw (v4) -- (2, -2.75);
        \draw (v4) -- (v5);
        \draw (v5) -- (4, -0.5);
        \draw (v5) -- (3.25, 0.75);
        \draw (v5) -- (v1);

        \pause
        \draw[very thick, color=green] (v1) -- (v3);
        \draw[very thick, color=green] (v1) -- (v4);

        \pause
        \draw[very thick, draw=red] (0,1) -- (-2,0) -- (-1,-2) -- cycle;

      \end{tikzpicture}
      \caption{Przykład triangulacji grafu poprzez dodanie krawędzi $(v_1, v_3)$ oraz $(v_1, v_4)$. W procesie tym powstały trzy cykle indukowane o długości 3.}
    \end{figure}
  \end{center}
\end{frame}

\begin{frame}
  \frametitle{Diagramy Voronoi}
  \begin{definition}
    Tesselacja to pokrycie płaszczyzny za pomocą wielokątów przylegających do siebie oraz nie nakładających się.
  \end{definition}

  \begin{definition}
    Diagram Voronoi to \textbf{podział płaszczyzny na obszary w oparciu o odległość do określonego zbioru punktów}. Każdy obszar składa się z punktów bliższych do jednego punktu z danego zbioru niż do jakiegokolwiek innego punktu ze zbioru. Jest to przykład tesselacji płaszczyzny.
  \end{definition}

  \pause
  Diagramy te zostały nazwane na cześć matematyka Gieorgija Woronoja, rosyjskiego matematyka ukraińskiego pochodzenia, który opisał je w 1908 roku.
\end{frame}

\begin{frame}
  \frametitle{Diagramy Voronoi}
  Niech $P = \{p_1, p_2, \ldots, p_n\}$, gdzie $p_i \in \mathbb{R}^2, n \in \mathbb{N}$.
  Punkty ze zbioru $P$ nazywać będziemy centrami.

  \begin{definition}
    Komórką diagramu Voronoi dla punktu $p_i$ nazywamy
    \begin{center}
      $V_P(p_i) = \{x : \forall_{j \neq i} d(x, p_i) \leq d(x, p_j) \}$
    \end{center}
    gdzie $d$ jest funkcją odległości między punktami.
  \end{definition}

  \pause
  \begin{definition}
    Podział płaszczyzny na $n$ komórek Voronoi $V_P(p_1), V_P(p_2), \ldots, V_P(p_n)$ nazywamy diagramem Voronoi dla zbioru punktów $P$. Oznaczamy go jako $Vor(P)$.
  \end{definition}
\end{frame}

\begin{frame}
  \frametitle{Diagramy Voronoi - przykład}
  \begin{center}
    \begin{figure}
      \includegraphics<1>[scale=0.4]{voronoi-animation-0}
      \includegraphics<2>[scale=0.4]{voronoi-animation-1}
      \includegraphics<3>[scale=0.4]{voronoi-animation-2}
      \caption{Przykład diagramu Voronoi dla metryki euklidesowej}
    \end{figure}
  \end{center}
\end{frame}

\begin{frame}
  \frametitle{Diagramy Voronoi - porównanie metryk}

  Do najpopularniejszych metryk używanych w diagramach Voronoi należą:
  \begin{itemize}
    \item Metryka euklidesowa \\
      $d[(a_1, a_2), (b_1, b_2)] = \sqrt{(a_1 - b_1)^2 + (a_2 - b_2)^2}$
    \item Metryka Manhattan \\
      $d[(a_1, a_2), (b_1, b_2)] = |a_1 - b_1| + |a_2 - b_2|$
    \item Metryka Czebyszewa \\
      $d[(a_1, a_2), (b_1, b_2)] = \max(|a_1 - b_1|, |a_2 - b_2|)$
  \end{itemize}
\end{frame}

\begin{frame}
  \frametitle{Diagramy Voronoi - porównanie metryk}
  \begin{center}
    \begin{figure}
      \includegraphics<1>[scale=0.35]{voronoi_euklidesowa}
      \includegraphics<2>[scale=0.35]{voronoi_manhattan}
      \includegraphics<3>[scale=0.35]{voronoi_czebyszewa}
      \only<1>{\caption{Diagram Voronoi dla metryki euklidesowej}}
      \only<2>{\caption{Diagram Voronoi dla metryki Manhattan}}
      \only<3>{\caption{Diagram Voronoi dla metryki Czebyszewa}}
    \end{figure}
  \end{center}
\end{frame}

\begin{frame}
  \frametitle{Diagramy Voronoi - algorytmy tworzenia}
  Do najpopularniejszych sposobów tworzenia diagramów Voronoi należą:
  \begin{itemize}
    \item \color<1>{violet}{\textbf{Rastrowy brute force} - dla każdej komórki siatki obliczana jest odległość do każdego punktu ze zbioru $P$, a komórka jest przypisywana do najbliższego punktu. Czas działania: $O(mn)$, gdzie $m$ to liczba komórek siatki, a $n$ to liczba punktów w zbiorze $P$.}
      \pause
    \item \color<2>{violet}{\textbf{Algorytm Fortune'a} - najczęściej stosowany, pozwala na zbudowanie diagramu Voronoi w czasie $O(n \log n)$ dla $n$ punktów wejściowych. Jest to algorytm zamiatający - linia omija zbiór punktów w określonym kierunku, a kiedy wszystkie punkty zostaną przetworzone, tworzony jest diagram Voronoi.}
      \pause
    \item \color<3>{violet}{\textbf{Obliczanie triangulacji Delaunaya} (\textit{Delone}) i tworzenie diagramu Voronoi na jej podstawie. Złożoność: $O(n \log n)$.}
  \end{itemize}
\end{frame}

\begin{frame}
  \frametitle{Diagramy Voronoi - Rastrowy brute force}

  \begin{algorithm}[H]
    \caption{Rastrowy brute force dla diagramu Voronoi}
    \begin{algorithmic}
      \Function{voronoiBruteForce}{siatka, punkty}
      \For{each komórka $c$ in siatka}
      \State $minimalnyDystans \gets \infty$
      \State $najbliższyPunkt \gets null$
      \For{each punkt $p$ in punkty}
      \State $dystans \gets d(c, p)$
      \If{$dystans < minimalnyDystans$}
      \State $minimalnyDystans \gets dystans$
      \State $najbliższyPunkt \gets p$
      \EndIf
      \EndFor
      \State przypisz komórkę $c$ do $najbliższyPunkt$
      \EndFor
      \State \Return siatka
      \EndFunction
    \end{algorithmic}
  \end{algorithm}
\end{frame}

\begin{frame}
  \frametitle{Diagramy Voronoi - Rastrowy brute force}

  \begin{center}
    \begin{figure}
      \begin{tikzpicture}[scale=0.5]
        \foreach \x in {0,1,...,19} {
          \foreach \y in {0,1,...,9} {
            \fill[gray!20] (\x, \y) rectangle (\x+1, \y+1);
          }
        }

        \foreach \x in {0,1,...,19} {
          \foreach \y in {0,1,...,9} {
            \pgfmathsetmacro{\distRed}{sqrt((\x+0.5-3)^2 + (\y+0.5-7)^2)}
            \pgfmathsetmacro{\distBlue}{sqrt((\x+0.5-9)^2 + (\y+0.5-8)^2)}
            \pgfmathsetmacro{\distGreen}{sqrt((\x+0.5-15)^2 + (\y+0.5-6)^2)}
            \pgfmathsetmacro{\distYellow}{sqrt((\x+0.5-13)^2 + (\y+0.5-2)^2)}
            \pgfmathsetmacro{\distPurple}{sqrt((\x+0.5-6)^2 + (\y+0.5-3)^2)}

            \pgfmathsetmacro{\minDist}{min(min(min(\distRed, \distBlue), min(\distGreen, \distYellow)), \distPurple)}

            \ifdim \minDist pt = \distRed pt
            \fill[red!50] (\x, \y) rectangle (\x+1, \y+1);
            \else\ifdim \minDist pt = \distBlue pt
            \fill[blue!50] (\x, \y) rectangle (\x+1, \y+1);
            \else\ifdim \minDist pt = \distGreen pt
            \fill[green!50] (\x, \y) rectangle (\x+1, \y+1);
            \else\ifdim \minDist pt = \distYellow pt
            \fill[yellow!50] (\x, \y) rectangle (\x+1, \y+1);
            \else
            \fill[purple!50] (\x, \y) rectangle (\x+1, \y+1);
            \fi\fi\fi\fi
          }
        }

        \fill[red!80!black] (3, 7) circle (0.4);
        \draw[white, very thick] (3, 7) circle (0.4);

        \fill[blue!80!black] (9, 8) circle (0.4);
        \draw[white, very thick] (9, 8) circle (0.4);

        \fill[green!60!black] (15, 6) circle (0.4);
        \draw[white, very thick] (15, 6) circle (0.4);

        \fill[yellow!80!orange] (13, 2) circle (0.4);
        \draw[black, very thick] (13, 2) circle (0.4);

        \fill[purple!80!black] (6, 3) circle (0.4);
        \draw[white, very thick] (6, 3) circle (0.4);
      \end{tikzpicture}
      \caption{Wizualizacja działania algorytmu rastrowego brute force dla siatki 20x10 oraz 5 punktów. Wykorzystano metrykę euklidesową.}
    \end{figure}
  \end{center}
\end{frame}

\begin{frame}
  \frametitle{Algorytm Fortune'a}
  Algorytm Fortune'a to \textbf{algorytm zamiatający} (\textit{sweep line algorithm}), pozwalający na efektywne tworzenie diagramów Voronoi w czasie $O(n \log n)$ wykorzystując $O(n)$ pamięci dla $n$ punktów wejściowych.
\end{frame}

\begin{frame}
  \frametitle{Algorytm Fortune'a - definicje}
  \begin{definitions}
    \textbf{Linia zamiatająca} (\textit{sweep line}) - linia prosta, przesuwająca się wzdłuż płaszczyzny, przetwarzająca punkty wejściowe.

    \textbf{Linia plażowa} (\textit{beach line}) - krzywa utworzona przez punkty równoodległe od linii zamiatającej i najbliższe z punktów już przetworzonych. Składa się z łuków parabolicznych.

    \textbf{Zdarzenia punktowe} (\textit{point events}) - miejsca, w których linia zamiatająca napotyka punkty wejściowe.

    \textbf{Zdarzenia wierzchołkowe} (\textit{vertex events}) - miejsca, w których zanikają łuki paraboliczne na linii plażowej.
  \end{definitions}

  \begin{center}
    \begin{figure}
      \includegraphics[scale=0.4]{sweep-beach-line}
      \caption{Linia zamiatająca i linia plażowa}
    \end{figure}
  \end{center}
\end{frame}

\begin{frame}
  \frametitle{Algorytm Fortune'a - zasada działania}
  \begin{itemize}
    \item Punkty znajdujące się \textbf{za linią zamiatającą nie mają wpływu na kształt linii plażowej}, gdyż nigdy nie będą spełniać warunku bycia najbliższym punktem dla żadnego punktu przed linią zamiatającą.
      \pause
    \item W trakcie działania algorytmu przesuwana jest linia zamiatająca wzdłuż płaszczyzny. Gdy \textbf{linia napotyka nowy punkt, tworzony jest nowy łuk paraboliczny} na linii plażowej, ponieważ ten punkt staje się najbliższym punktem dla pewnego obszaru przed linią zamiatającą. Zdarzenie to nazywane jest zdarzeniem punktowym.
  \end{itemize}

  \begin{center}
    \begin{figure}
      \includegraphics[scale=0.5]{point-event}
      \caption{Zdarzenie punktowe - dodanie nowego łuku parabolicznego}
    \end{figure}
  \end{center}
\end{frame}

\begin{frame}
  \frametitle{Algorytm Fortune'a - zasada działania}
  \begin{itemize}
    \item W trakcie przesuwania linii zamiatającej, łuki paraboliczne tworzące linię plażową będą się zmieniać. Gdy \textbf{linia zamiatająca osiągnie punkt, w którym trzy łuki paraboliczne stykają się w jednym punkcie, środkowy łuk zniknie}, a dwa pozostałe połączą się. Zdarzenie to nazywane jest zdarzeniem wierzchołkowym.
      \pause
    \item Efektem zdarzenia wierzchołkowego jest \textbf{utworzenie nowego wierzchołka diagramu Voronoi}, ponieważ punkt styku trzech łuków parabolicznych jest równoodległy od trzech punktów wejściowych.
  \end{itemize}

  \begin{center}
    \begin{figure}
      \includegraphics[scale=0.7]{vertex-event}
      \caption{Zdarzenie wierzchołkowe}
    \end{figure}
  \end{center}
\end{frame}

\begin{frame}
  \frametitle{Algorytm Fortune'a - przykład}
  \begin{center}
    \begin{figure}
      \includegraphics<1>[scale=0.8]{fortunes-animation-0}
      \includegraphics<2>[scale=0.8]{fortunes-animation-1}
      \includegraphics<3>[scale=0.8]{fortunes-animation-2}
      \includegraphics<4>[scale=0.8]{fortunes-animation-3}
      \includegraphics<5>[scale=0.8]{fortunes-animation-4}
      \includegraphics<6>[scale=0.8]{fortunes-animation-5}
      \includegraphics<7>[scale=0.8]{fortunes-animation-6}
      \includegraphics<8>[scale=0.8]{fortunes-animation-7}
      \caption{Przykład działania algorytmu Fortune'a}
    \end{figure}
  \end{center}
\end{frame}

\begin{frame}
  \frametitle{Algorytm Fortune'a - ilość paraboli na linii plażowej}
  Jak można zauważyć na przedstawionym przykładzie, każde zdarzenie punktowe powoduje dodanie nowego łuku parabolicznego na linii plażowej, jednocześnie mogąc powodować podział istniejącego łuku na dwa mniejsze łuki. W takim przypadku \textbf{zdarzenie punktowe może powodować zwiększenie liczby łuków na linii plażowej o maksymalnie dwa.}
  Warto zauważyć, że dla pierwszego punktu zawsze tworzony jest dokładnie jeden łuk paraboliczny.

  \pause
  \begin{theorem}
    Dla zbioru $n$ punktów wejściowych, linia plażowa w algorytmie Fortune'a może składać się z maksymalnie $2n - 1$ łuków parabolicznych. \qed
  \end{theorem}
\end{frame}

\begin{frame}
  \frametitle{Algorytm Fortune'a - struktury danych}
  Algorytm Fortune'a wykorzystuje dwie główne struktury danych:
  \begin{itemize}
    \item \textbf{Kolejka priorytetowa} - przechowuje zdarzenia punktowe i wierzchołkowe, posortowane według ich pozycji na osi wzdłuż której przesuwa się linia zamiatająca.
      \pause
    \item \textbf{Drzewo binarne} - reprezentuje linię plażową, przechowując łuki paraboliczne w kolejności od lewej do prawej jako węzły drzewa.
  \end{itemize}

  \begin{center}
    \begin{figure}
      \includegraphics[scale=0.4]{beach-line-binary-tree}
      \caption{Proces dodawania reprezentacji nowej paraboli do drzewa binarnego opisującego linię plażową}
    \end{figure}
  \end{center}
\end{frame}

\begin{frame}
  \frametitle{Algorytm Fortune'a - pseudokod}

  \begin{algorithm}[H]
    \caption{Algorytm Fortune'a}
    \begin{algorithmic}
      \Function{voronoiFortune}{punkty}
      \State $kolejkaZdarzen \gets$ zdarzenia punktowe utworzone z $punkty$
      \State $liniaPlazowa \gets$ puste drzewo binarne
      \State $diagramVoronoi \gets$ pusty diagram Voronoi

      \While {kolejkaZdarzen nie jest pusta}
      \State $zdarzenie \gets$ usuń pierwsze zdarzenie z $kolejkaZdarzen$
      \If{$zdarzenie$ jest zdarzeniem punktowym}
      \State dodajParabolę($zdarzenie$)
      \Else
      \State usuńParabolę($zdarzenie$)
      \EndIf
      \EndWhile
      \EndFunction
    \end{algorithmic}
  \end{algorithm}
\end{frame}

\begin{frame}
  \frametitle{Algorytm Fortune'a - pseudokod}

  \begin{algorithm}[H]
    \caption{Algorytm Fortune'a - dodajParabolę}
    \begin{algorithmic}
      \Function{dodajParabolę}{$zdarzenie$}
      \If{$liniaPlazowa$ jest pusta} dodaj nową parabolę do $liniaPlazowa$ i zakończ funkcję \EndIf
      \State
      \State $parabola$ $\gets$ parabola znajdująca się pod punktem $zdarzenie$
      \State \textbf{usuń} z $kolejkaZdarzen$ wszelkie zdarzenia wierzchołkowe związane z $parabola$
      \State
      \State \textbf{podziel} $parabola$ na dwa mniejsze łuki i dodaj nową parabolę między nimi do $liniaPlazowa$
      \State sprawdź czy dla nowych łuków \textbf{istnieją zdarzenia wierzchołkowe} (czyli jeden z łuków zanika, bo odległość od 3 punktów jest równa) i dodaj je do $kolejkaZdarzen$
      \EndFunction
    \end{algorithmic}
  \end{algorithm}
\end{frame}

\begin{frame}
  \frametitle{Algorytm Fortune'a - pseudokod}

  \begin{algorithm}[H]
    \caption{Algorytm Fortune'a - usuńParabolę}
    \begin{algorithmic}
      \Function{usuńParabolę}{$zdarzenie$}
      \State $lewaParabola, prawaParabola \gets$ parabolę po lewej i prawej stronie paraboli znikającej w zdarzeniu $zdarzenie$
      \State \textbf{usuń} z $kolejkaZdarzen$ wszelkie zdarzenia wierzchołkowe związane z $lewaParabola$ i $prawaParabola$
      \State
      \State $srodekOkregu \gets$ punkt styku łuków parabolicznych w zdarzeniu $zdarzenie$
      \State \textbf{dodaj} nowy wierzchołek do $diagramVoronoi$ w $srodekOkregu$
      \State
      \State \textbf{usuń} parabolę znikającą w zdarzeniu $zdarzenie$ z $liniaPlazowa$
      \State sprawdź czy dla $lewaParabola$ i $prawaParabola$ \textbf{istnieje zdarzenie wierzchołkowe} i dodaj je do $kolejkaZdarzen$
      \EndFunction
    \end{algorithmic}
  \end{algorithm}
\end{frame}

\begin{frame}
  \frametitle{Algorytm Fortune'a - oszacowanie złożoności i dowód}

  \begin{theorem}
    Każdy wierzchołek diagramu Voronoi jest stopnia trzeciego. \qed
  \end{theorem}

  \begin{theorem}
    Algorytm Fortune'a tworzy diagram Voronoi dla $n$ punktów wejściowych w czasie $O(n \log n)$ wykorzystując $O(n)$ pamięci.
  \end{theorem}
\end{frame}

\begin{frame}
  \frametitle{Algorytm Fortune'a - oszacowanie złożoności i dowód}
  \begin{small}
    \begin{proof}
      Niech $V$ będzie liczbą wierzchołków, $E$ liczbą krawędzi, a $N$ liczbą ścian diagramu Voronoi.

      Ponieważ diagram Voronoi posiada nieskończone ściany, \textbf{dodajemy do niego sztuczny wierzchołek} i łączymy go z wszystkimi nieskończonymi krawędziami, tworząc nowy graf planarny. Z \textbf{wzoru Eulera dla grafów planarnych} mamy $V - E + N = 2$. W takim razie $(V + 1) - E + N = 2$.
      \pause

      Każdy \textbf{wierzchołek diagramu Voronoi ma stopień co najmniej 3}, więc $3(V + 1) \leq 2E$. Po prostych przekształceniach otrzymujemy $V \leq 2N - 5$ oraz $E \leq 3N - 6$.

      \pause
      Liczba zdarzeń punktowych wynosi dokładnie $N$, a liczba zdarzeń wierzchołkowych $V$, którą możemy górnie ograniczyć przez $2N - 5$. Zatem \textbf{łączna liczba zdarzeń możemy oszacować przez $O(n)$}.

      Każde zdarzenie wywołuje stałą liczbę operacji $c$ na drzewie binarnym i kolejce priorytetowej. \textbf{Operacje te mają złożoność $O(\log n)$}. Zatem całkowity czas działania algorytmu wynosi $O(n \log n)$.
    \end{proof}
  \end{small}
\end{frame}

\begin{frame}
  \frametitle{Triangulacja Delaunaya}

  \begin{definitions}
    \textbf{Otoczka wypukła} zbioru punktów to najmniejszy wypukły wielokąt, który zawiera wszystkie punkty ze zbioru.

    \textbf{Triangulacja Delaunaya} (\textit{Delone}) zbioru punktów dzieli ich otoczkę wypukłą na trójkąty w taki sposób, że \textbf{żaden punkt ze zbioru nie znajduje się wewnątrz okręgu opisanego na żadnym z trójkątów triangulacji}.
  \end{definitions}

  Nazwa Triangulacji Delaunaya pochodzi od rosyjskiego matematyka Borysa Delaunaya, który opisał ją w 1934 roku.
\end{frame}

\begin{frame}
  \frametitle{Triangulacja Delaunaya}
  W triangulacji Delaunaya dla zbioru punktów $P$:
  \begin{itemize}
    \item Każdy trójkąt ma swoje wierzchołki w punktach ze zbioru $P$.
    \item Dla każdego trójkąta, okrąg opisany na nim nie zawiera żadnego innego punktu ze zbioru $P$ wewnątrz siebie.
    \item Podział taki maksymalizuje minimalny kąt wszystkich trójkątów w triangulacji.
  \end{itemize}
\end{frame}

\begin{frame}
  \frametitle{Triangulacja Delaunaya - przykład}
  \begin{center}
    \begin{figure}
      \includegraphics[scale=0.19]{delaunay-0}
      \caption{Przykład triangulacji Delaunaya dla zbioru punktów}
    \end{figure}
  \end{center}
\end{frame}

\begin{frame}
  \frametitle{Triangulacja Delaunaya - związek z diagramem Voronoi}
  \begin{definition}
    \textbf{Graf dualny} to graf utworzony z innego grafu poprzez umieszczenie wierzchołka w każdej ścianie oryginalnego grafu oraz połączenie tych wierzchołków krawędziami, jeśli ich odpowiadające ściany w oryginalnym grafie sąsiadują ze sobą.
  \end{definition}

  \pause
  \begin{theorem}
    Triangulacja Delaunaya dla zbioru punktów $P$ jest grafem dualnym diagramu Voronoi utworzonego z tego samego zbioru punktów $P$. \qed
  \end{theorem}
\end{frame}

\begin{frame}
  \frametitle{Triangulacja Delaunaya - związek z diagramem Voronoi}
  \begin{center}
    \begin{figure}
      \includegraphics<1>[scale=0.19]{delaunay-1}
      \includegraphics<2>[scale=0.19]{delaunay-2}
      \only<1>{\caption{Triangulacja Delaunaya z zaznaczonymi na czerwono środkami okręgów opisanych na trójkątach}}
      \only<2>{\caption{Graf dualny triangulacji Delaunaya, czyli diagram Voronoi - zaznaczony na czerwono}}
    \end{figure}
  \end{center}
\end{frame}

\begin{frame}
  \frametitle{Zastosowania}
  Triangulacja i diagramy Voronoi znajdują zastosowanie między innymi w:
  \begin{itemize}
    \item Planowaniu chirurgicznym i tworzeniu modeli 3D narządów
    \item Epidemiologii przestrzennej i analizie ognisk chorób
    \item Przedstawianiu struktury kosmicznej we wszechświecie
  \end{itemize}
\end{frame}

\begin{frame}
  \frametitle{Zastosowania}
  \begin{center}
    \only<1>{
      \begin{figure}
        \includegraphics[scale=0.3]{bone-triangulation}
        \caption{Triangulacja wykorzystana do przybliżenia kształtu kości ludzkiej w celu planowania chirurgicznego}
      \end{figure}
    }
    \only<2>{
      \begin{figure}
        \includegraphics[scale=0.4]{cholera-voronoi}
        \caption{Diagram Voronoi wykorzystany do analizy przestrzennej ogniska cholery w Londynie w 1854 roku}
      \end{figure}
    }
    \only<3>{
      \begin{figure}
        \includegraphics[scale=0.4]{3d-tesselation-cosmic-structure}
        \caption{Trójwymiarowa tesselacja wykorzystana do przedstawienia struktury kosmicznej we wszechświecie}
      \end{figure}
    }
  \end{center}
\end{frame}

\begin{frame}
  \frametitle{Źródła}

  \only<1>{
    \begin{thebibliography}{9}
      \bibitem{1} \url{https://mathworld.wolfram.com/Triangulation.html}
      \bibitem{2} \url{https://en.wikipedia.org/wiki/Triangulation_(disambiguation)}
      \bibitem{3} \url{https://en.wikipedia.org/wiki/Planar_graph}
      \bibitem{4} \url{https://en.wikipedia.org/wiki/Chordal_graph}
      \bibitem{5} \url{https://en.wikipedia.org/wiki/Simplex}
      \bibitem{6} \url{https://facultyweb.kennesaw.edu/mlavrov/courses/graph-theory/lecture21.pdf}
      \bibitem{7} \url{https://mathworld.wolfram.com/Goldner-HararyGraph.html}
      \bibitem{8} \url{https://en.wikipedia.org/wiki/Voronoi_diagram}
      \bibitem{9} \url{https://en.wikipedia.org/wiki/Tessellation}
    \end{thebibliography}
  }
  \only<2>{
    \begin{thebibliography}{9}
      \bibitem{1} \url{https://www.math.us.edu.pl/lsim2014/MSerwecinska-lsim2014.pdf}
      \bibitem{2} \url{https://jacquesheunis.com/post/fortunes-algorithm/}
      \bibitem{3} \url{https://cs.sfu.ca/~binay/813.2011/Fortune.pdf}
      \bibitem{4} \url{https://blog.ivank.net/fortunes-algorithm-and-implementation.html}
      \bibitem{5} \url{https://en.wikipedia.org/wiki/Delaunay_triangulation}
      \bibitem{6} \url{https://ianthehenry.com/posts/delaunay/}
      \bibitem{7} \url{https://plus.maths.org/content/uncovering-cause-cholera}
      \bibitem{8} \url{https://www.researchgate.net/publication/221909127_Finite_Element_Analysis_in_Orthopaedic_Biomechanics}
      \bibitem{9} \url{https://www.astro.rug.nl/~weygaert/tim1publication/vorwey.isvd07.pdf}
    \end{thebibliography}
  }
\end{frame}

\end{document}
